
from Crypto.Util.number import getPrime, long_to_bytes
import random
import hashlib
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
pubA = 1500866860025330076516645272835803105091787863637882020181241850175177416282468645206745010494368702612013126250325416704940928462565296342480750480982173166260394249779800930649396906063607429298770451138995932992746955056324934910897285159073489209190689058035028698055176393095522935699741451623141764112195449247728866374960149330822679999023237728597579827312966868175401704525038419657514943672147908807047555834412498435379265534618148475400729910128958999
p = 1975190211203857600355830064862443893810583511782963119647523465322890843654972282506546703042266684764647796900238589298716200312422279897256921044104803469254441697557105329302578808641067192432633432150394829283006095789323550505938634115083904477644555177639024458229379946500373371631296694270199594158961416422898643613456823729308560440257285351207920047997264423526412118433768096912704646086479706460166124287860906480060241695143429655579292524719788299
priv_b = 997290207412607132627405802655609573301563498975665636729307337368122217991689148573042435795383104772590393003835372096086908783793767735681472212479612505902364214755374110605405753193537724694799719708931149981228624842583088916012424693327105480447168121549714471005054494279975911439913963442241480740196839548067544083728808650118826502418270113705649752037802300758538389061735247741490491302290792466824629753820369113092915417779519695974421715392508851

encrypted_flag = "5b4c5abf8016cc88adc3d04a98499c646f4aa53609268e4a035dee53434009ec"
shared_secret = pow(pubA, priv_b, p)
key = hashlib.sha256(long_to_bytes(shared_secret)).digest()[:16]
print(key)
cipher = AES.new(key, AES.MODE_ECB)
ct = cipher.decrypt(bytes.fromhex(encrypted_flag))
print(ct)
