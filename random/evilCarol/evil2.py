
from Crypto.Util.number import getPrime, long_to_bytes
import random
import hashlib
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
pubA = 520304318664966559549543938221938143679893083452497993993935126308338209972411513775617705026379036122903198926035062310683801830767222262112433646098448591958221866380466959741098580402270865606511293121337596195471682179076500722533419421528627353362557503264274117137614941670447263010170652069667289733200819700812157941260138371481443572407473266004495094497313217600617494613777593239445715277671631277434670737259879565034255289557988586802667635893656886
p = 1789723371203359391070857052784030500380638720375375148805913077160973126666441935676347422641006231986969982868626569371170980331570604974329322319428572950761426978758706791160378038907371715232175165497825676686091820249540914135824206287461834255936316964798753821133778923427700991847972482241910737347007463964136177328848878053593014044769083691557685552962028986280423095503621262559461164777846997005563777836449645126469942505970231790340312898983583481
priv_b = 2166806639062939895331749343613175228573220391584151446845247311417455675411488542617365510074364049135470294158407659061039950836570574969611913896110091468337364914871054602494304669456789543326286972590182297114751792220374331624175439550443134591417507086065115108531002455347767242199097544239715502448882052938550155386301968942355341236950258248176440205856070236268477425632162321279215078073791447953440556798939125460526336753432175043687727587035378541

encrypted_flag = "fdecd91b401ed4b8a6d39b0e4554a5bf6da9511e12c1ede426733e76eb09d5c80dc55f29bfbbe340d3fca8d680348f87"
shared_secret = pow(pubA, priv_b, p)
key = hashlib.sha256(long_to_bytes(shared_secret)).digest()[:16]
cipher = AES.new(key, AES.MODE_ECB)
ct = cipher.decrypt(bytes.fromhex(encrypted_flag))
print(ct)